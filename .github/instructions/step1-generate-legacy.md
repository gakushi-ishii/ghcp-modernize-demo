---
title: "Step 1: レガシーアプリ生成ルール"
description: "Copilot がレガシー言語のアプリを生成する際のガイドライン（言語不問）"
applyTo: "workspace/legacy/**"
excludeAgent: "code-review"
---

# Step 1: レガシーアプリ生成ルール

このインストラクションは、GitHub Copilot がレガシーアプリを生成する際のガードレールです。
**どの言語を選択しても**、デモ環境で確実に動作し、後のモダナイズ（Step 2）につなげやすいコードを生成させることを目的としています。

---

## 環境制約（言語不問）

以下の制約は COBOL、VB6、Perl、FORTRAN など **あらゆるレガシー言語に適用** されます：

- **データベース不使用** — ファイルベース（CSV, JSON, 固定長テキスト等）で永続化する
- **外部 API 不使用** — ネットワーク通信なし
- **追加ミドルウェア不使用** — 言語標準のランタイムのみで動作
- **OS 固有機能を避ける** — クロスプラットフォーム対応（できるだけ）
- **外部パッケージ最小限** — 言語の標準ライブラリ範囲で実装

## アプリケーション設計

- **CLI アプリケーション** として実装（GUI・Web UI は不要）
- **サンプルデータ必須** — クローン直後に動作確認できる状態に
- **ビジネスロジック必須** — 計算処理・バリデーション・条件分岐を最低 2～3 個含める
- **1 ファイル 300 行以内** に収める（読みやすく、Step 2 で変換しやすく）
- **関数・サブルーチン単位** でモジュール化
- **メイン処理フローが明確** に構成

## 出力先・ディレクトリ構成

```
workspace/legacy/
├── <main-source-file>    # 言語によって異なる (*.cbl, *.bas, *.pl 等)
├── data/                 # サンプルデータファイル
│   └── *.csv (or *.json, *.txt)
├── output/               # 実行結果の出力先（初期は空）
└── docs/
    ├── how-to-run.md     # 実行手順
    └── specification.md  # 入出力仕様・ビジネスロジック
```

## ドキュメント生成（必須）

### `how-to-run.md` — 動作確認手順

言語ごとに異なるため、以下を記載：

- 必要な環境・ランタイムのバージョン
- インストール手順（言語系ツール）
- ビルド手順（必要な場合）
- 実行コマンド（実行例を含める）
- 期待される出力結果の例

### `specification.md` — 入出力仕様・ビジネスロジック

以下を記載：

- **入力ファイルの形式** — カラム定義、データ型、サンプル
- **出力結果の形式** — カラム定義、データ型、サンプル
- **ビジネスロジック** — 計算式、条件判定、閾値等の詳細

## コード品質

- **日本語でコメント記載** — 言語の標準に従った形式で
- **命名規則** — 言語の慣習に従う（COBOL なら大文字、VB なら PascalCase 等）
- **エラーハンドリング** — 最低限のチェック（ファイル存在確認など）
- **出力フォーマット** — CSV・JSON・テキスト形式を明確に

---

## チェックリスト

生成後、以下を確認してください：

- [ ] `workspace/legacy/docs/how-to-run.md` が存在し、実行手順が明確
- [ ] `workspace/legacy/docs/specification.md` が存在し、入出力仕様が記載
- [ ] `workspace/legacy/data/` にサンプルデータが含まれている
- [ ] 実際に動作確認できている（`how-to-run.md` の手順に従って）
- [ ] ソースコードに日本語コメントが含まれている
