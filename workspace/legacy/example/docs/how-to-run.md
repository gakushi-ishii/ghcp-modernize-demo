# 在庫管理システム 実行手順書

## 前提条件

- Windows OS
- cscript.exe（Windows 標準で利用可能）

## ファイル構成

```
workspace/legacy/example/
├── inventory.vbs        # メインプログラム
├── data/
│   ├── inventory.csv    # 在庫マスタ
│   └── transactions.csv # 入出庫履歴
└── docs/
    ├── how-to-run.md    # このファイル
    └── specification.md # 仕様書
```

## 実行方法

### 基本構文

```cmd
cd workspace\legacy\example
cscript //nologo inventory.vbs <コマンド> [引数]
```

### コマンド一覧

#### 1. 在庫一覧を表示

```cmd
cscript //nologo inventory.vbs list
```

出力例:
```
================================================
在庫一覧
================================================
------------------------------------------------------------
コード  商品名          在庫数  閾値
------------------------------------------------------------
P001    ノートパソコン  15      10
P002    マウス          45      20
...
------------------------------------------------------------
合計 8 件
```

#### 2. 入庫処理（在庫増加）

```cmd
cscript //nologo inventory.vbs in P001 10
```

出力例:
```
================================================
入庫処理完了
================================================
商品コード: P001
商品名: ノートパソコン
入庫数量: 10
変更前在庫: 15
変更後在庫: 25
```

#### 3. 出庫処理（在庫減少）

```cmd
cscript //nologo inventory.vbs out P002 5
```

出力例:
```
================================================
出庫処理完了
================================================
商品コード: P002
商品名: マウス
出庫数量: 5
変更前在庫: 45
変更後在庫: 40
```

#### 4. 在庫不足アラート

```cmd
cscript //nologo inventory.vbs alert
```

出力例:
```
================================================
在庫不足アラート
================================================

[警告] P003 - キーボード
  現在庫: 8 / 閾値: 15
  不足数: 8

[警告] P005 - USBメモリ
  現在庫: 5 / 閾値: 30
  不足数: 26

------------------------------------------------------------
アラート対象: 2 件
```

#### 5. 在庫レポート出力

```cmd
cscript //nologo inventory.vbs report
```

出力例:
```
================================================
在庫レポート
================================================
出力日時: 2026/02/10 10:30:00
----------------------------------------------------------------------
コード  商品名          在庫    単価        在庫金額
----------------------------------------------------------------------
P001    ノートパソコン  15      89,800      1,347,000
P002    マウス          45      2,980       134,100
...
----------------------------------------------------------------------

【サマリー】
  総商品数: 8 種類
  総在庫数: 141 個
  総在庫金額: 2,XXX,XXX 円

【注意】在庫不足商品: X 件
  詳細は alert コマンドで確認してください。
```

## エラーメッセージ

| エラー | 原因 | 対処法 |
|--------|------|--------|
| 商品が見つかりません | 存在しない商品コードを指定 | inventory.csv を確認 |
| 在庫が不足しています | 出庫数量 > 現在庫数 | 在庫を確認して数量を調整 |
| ファイルが見つかりません | CSV ファイルが存在しない | data/ フォルダを確認 |

## データファイル形式

### inventory.csv（在庫マスタ）

```csv
商品コード,商品名,現在庫数,最低在庫数,単価
P001,ノートパソコン,15,10,89800
P002,マウス,45,20,2980
...
```

### transactions.csv（入出庫履歴）

```csv
日時,商品コード,処理種別,数量
2026/02/10 10:30:00,P001,IN,10
2026/02/10 11:00:00,P002,OUT,5
...
```

## トラブルシューティング

### 文字化けが発生する場合

このプログラムは Shift-JIS エンコーディングで作成されています。
ファイルを編集する場合は、Shift-JIS で保存してください。

### PowerShell で実行する場合

PowerShell からも同様に実行できます：

```powershell
cd workspace\legacy\example
cscript //nologo inventory.vbs list
```
